@model GestionStages.Models.Candidature

@{
    ViewData["Title"] = "Détails de la candidature";
}

<h1>Détails de la candidature</h1>

<hr />

<div class="row">
    <div class="col-md-8">
        <dl class="row">
            <dt class="col-sm-4">Étudiant</dt>
            <dd class="col-sm-8">
                @Html.DisplayFor(model => model.Etudiant.Nom) @Html.DisplayFor(model => model.Etudiant.Prenom)
            </dd>

            <dt class="col-sm-4">Email</dt>
            <dd class="col-sm-8">
                @Html.DisplayFor(model => model.Etudiant.Email)
            </dd>

            <dt class="col-sm-4">Offre de stage</dt>
            <dd class="col-sm-8">
                <strong>@Html.DisplayFor(model => model.OffreStage.Titre)</strong>
            </dd>

            <dt class="col-sm-4">Entreprise</dt>
            <dd class="col-sm-8">
                @Html.DisplayFor(model => model.OffreStage.Entreprise.Nom)
            </dd>

            <dt class="col-sm-4">Date de candidature</dt>
            <dd class="col-sm-8">
                @Model.DateCandidature.ToString("dd/MM/yyyy")
            </dd>

            <dt class="col-sm-4">Statut</dt>
            <dd class="col-sm-8">
                @if (Model.Statut == "Acceptée")
                {
                    <span class="badge bg-success fs-6">✓ @Model.Statut</span>
                }
                else if (Model.Statut == "Refusée")
                {
                    <span class="badge bg-danger fs-6">✗ @Model.Statut</span>
                }
                else
                {
                    <span class="badge bg-warning text-dark fs-6">⏳@Model.Statut</span>
                }
            </dd>

            <dt class="col-sm-4">Curriculum Vitae</dt>
            <dd class="col-sm-8">
                @if (!string.IsNullOrEmpty(Model.CheminCV))
                {
                    <a href="@Model.CheminCV" target="_blank" class="btn btn-primary">
                        Télécharger le CV
                    </a>
                }
                else
                {
                    <em class="text-muted">Aucun CV téléversé</em>
                }
            </dd>
        </dl>

        <!-- Description de l'offre -->
        <div class="card mt-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0">Description de l'offre</h5>
            </div>
            <div class="card-body">
                <p>@Html.DisplayFor(model => model.OffreStage.Description)</p>
                <p>
                    <strong>Durée :</strong> @Html.DisplayFor(model => model.OffreStage.DureeMois) mois<br />
                    <strong>Date de début souhaitée :</strong> @(Model.OffreStage.DateDebutSouhaitee?.ToString("dd/MM/yyyy") ?? "Non spécifiée")
                </p>
            </div>
        </div>

        <!-- Boutons d'action -->
        <div class="mt-4">
            @if (User.IsInRole("Admin") || User.IsInRole("Entreprise"))
            {
                <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn btn-warning">✏️ Modifier</a>
            }

            @if (User.IsInRole("Admin") || User.IsInRole("Etudiant"))
            {
                <a asp-action="Delete" asp-route-id="@Model?.Id" class="btn btn-danger">🗑️ Annuler</a>
            }

            <a asp-action="Index" class="btn btn-secondary">← Retour à la liste</a>
        </div>
    </div>
</div>
